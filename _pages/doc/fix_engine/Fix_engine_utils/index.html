<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Fix_engine_utils (fix_engine.Fix_engine_utils)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">fix_engine</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Fix_engine_utils</span></h1></header><p>FIX 4.4 engine utility functions.</p><div class="spec type" id="type-session_details"><a href="#type-session_details" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>session_details</code><code></code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-session_details.constant_begin_string" class="anchored"><td class="def field"><a href="#type-session_details.constant_begin_string" class="anchor"></a><code>constant_begin_string : <a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a>;</code></td></tr></table><code>}</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-default_session_details"><a href="#val-default_session_details" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>default_session_details : <a href="index.html#type-session_details">session_details</a></code></div><div class="doc"></div></div><div class="spec val" id="val-msg_is_sequence_gap"><a href="#val-msg_is_sequence_gap" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>msg_is_sequence_gap : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span><a href="../../protocol/Full_messages/index.html#type-fix_header">Full_messages.fix_header</a>) <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p>If sequence number is too high, then we need to transfer into Recovery Mode
and request the missing sequence to be retransmitted.</p></div></div><div class="spec val" id="val-get_historic_msg"><a href="#val-get_historic_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_historic_msg : <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a> <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>get_gap_fill_msg -&gt; out of all of the administrative messages, only the 'Reject' can be retransmitted.
All application-level messages may be retransmitted - we should, in the future add logic to
not retransmit stale orders, etc.</p></div></div><div class="spec val" id="val-get_critical_reset_seq_num"><a href="#val-get_critical_reset_seq_num" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_critical_reset_seq_num : <a href="../../protocol/Full_messages/index.html#type-full_msg_data">Full_messages.full_msg_data</a> <span class="keyword">&#8209;&gt;</span> int option</code></div><div class="doc"><p>This function returns a new sequence number if we got a SequenceReset without GapFill flag.
Returns None in all other cases.</p></div></div><div class="spec val" id="val-combine_gapfill_msgs"><a href="#val-combine_gapfill_msgs" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>combine_gapfill_msgs : (<a href="../../protocol/Full_admin_messages/index.html#type-full_msg_sequence_reset_data">Full_admin_messages.full_msg_sequence_reset_data</a><span class="keyword"> * </span><a href="../../protocol/Full_admin_messages/index.html#type-full_msg_sequence_reset_data">Full_admin_messages.full_msg_sequence_reset_data</a>) <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_admin_messages/index.html#type-full_msg_sequence_reset_data">Full_admin_messages.full_msg_sequence_reset_data</a></code></div><div class="doc"><p>Give us a single GapFill message with the correct NextSequenceNumber.</p><p>From the specification:
&quot;If there are consecutive administrative messages to be resent, it is suggested that only one SeqReset-GapFill
message be sent in their place. The sequence number of the SeqReset-GapFill message is the next expected
outbound sequence number. The NewSeqNo field of the GapFill message contains the sequence number of
the highest administrative message in this group plus 1. For example, during a Resend operation there are 7
sequential administrative messages waiting to be resent. They start with sequence number 9 and end with
sequence number 15. Instead of transmitting 7 Gap Fill messages (which is perfectly legal, but not network
friendly), a SeqReset-GapFill message may be sent. The sequence number of the Gap Fill message is set to 9
because the remote side is expecting that as the next sequence number. The NewSeqNo field of the GapFill
message contains the number 16, because that will be the sequence number of the next message to be
transmitted.&quot;</p></div></div><div class="spec val" id="val-add_msg_to_history"><a href="#val-add_msg_to_history" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_msg_to_history : (<a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a> list<span class="keyword"> * </span><a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a>) <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a> list</code></div><div class="doc"><p>Adding a valid message to the list, while
</p><ul><li>converting any message that needs to be converted into a SequenceRest-GapFill</li><li>ensuring that any two sequential SequenceReset-GapFill messages are combined into one with an updated
expected NextSeqNum parameter</li></ul></div></div><div class="spec val" id="val-create_outbound_fix_msg"><a href="#val-create_outbound_fix_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_outbound_fix_msg : (int<span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a><span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a><span class="keyword"> * </span><a href="../../core/Datetime/index.html#type-fix_utctimestamp">Datetime.fix_utctimestamp</a><span class="keyword"> * </span><a href="../../protocol/Full_messages/index.html#type-full_msg_data">Full_messages.full_msg_data</a><span class="keyword"> * </span>bool) <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create outbound FIX message with the appropriate header and trailer.</p></div></div><div class="spec val" id="val-create_logon_msg"><a href="#val-create_logon_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_logon_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create a logon message we would send out to initiate a connection
with another FIX engine.</p></div></div><div class="spec val" id="val-create_logoff_msg"><a href="#val-create_logoff_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_logoff_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create a Logoff message.</p></div></div><div class="spec val" id="val-create_heartbeat_msg"><a href="#val-create_heartbeat_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_heartbeat_msg : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a> option) <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create a heartbeat message</p></div></div><div class="spec val" id="val-create_test_request_msg"><a href="#val-create_test_request_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_test_request_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create Test Request message.</p></div></div><div class="spec val" id="val-create_resend_request_msg"><a href="#val-create_resend_request_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_resend_request_msg : <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create Resend Request message.</p></div></div><div class="spec val" id="val-create_session_reject_msg"><a href="#val-create_session_reject_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_session_reject_msg : (int<span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a><span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a><span class="keyword"> * </span><a href="../../core/Datetime/index.html#type-fix_utctimestamp">Datetime.fix_utctimestamp</a><span class="keyword"> * </span><a href="../../protocol/Full_messages/index.html#type-session_rejected_msg_data">Full_messages.session_rejected_msg_data</a>) <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create session-rejection message.</p></div></div><div class="spec val" id="val-create_business_reject_msg"><a href="#val-create_business_reject_msg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_business_reject_msg : (int<span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a><span class="keyword"> * </span><a href="../../core/Base_types/index.html#type-fix_string">Base_types.fix_string</a><span class="keyword"> * </span><a href="../../core/Datetime/index.html#type-fix_utctimestamp">Datetime.fix_utctimestamp</a><span class="keyword"> * </span><a href="../../protocol/Full_messages/index.html#type-biz_rejected_msg_data">Full_messages.biz_rejected_msg_data</a>) <span class="keyword">&#8209;&gt;</span> <a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a></code></div><div class="doc"><p>Create business reject message.
Note: the reason we're separating the ApplicationDown reason is that the parser would not have access to this information.</p></div></div><div class="spec val" id="val-noop"><a href="#val-noop" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>noop : (<a href="../../protocol/Full_messages/index.html#type-full_valid_fix_msg">Full_messages.full_valid_fix_msg</a><span class="keyword"> * </span><a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a>) <span class="keyword">&#8209;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a></code></div><div class="doc"><p>A NO-OPeration</p></div></div><div class="spec val" id="val-business_reject"><a href="#val-business_reject" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>business_reject : (<a href="../../protocol/Full_messages/index.html#type-biz_rejected_msg_data">Full_messages.biz_rejected_msg_data</a><span class="keyword"> * </span><a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a>) <span class="keyword">&#8209;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a></code></div><div class="doc"><p>Convert the rejection information into an outbound BusinessReject message.</p></div></div><div class="spec val" id="val-session_reject"><a href="#val-session_reject" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>session_reject : (<a href="../../protocol/Full_messages/index.html#type-session_rejected_msg_data">Full_messages.session_rejected_msg_data</a><span class="keyword"> * </span><a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a>) <span class="keyword">&#8209;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a></code></div><div class="doc"><p>Convert the rejection information into an outbound Reject message.</p></div></div><div class="spec val" id="val-field_null"><a href="#val-field_null" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>field_null : int option <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"></div></div><div class="spec val" id="val-hbeat_interval_null"><a href="#val-hbeat_interval_null" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>hbeat_interval_null : <a href="../../core/Datetime/index.html#type-fix_duration">Datetime.fix_duration</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"></div></div><div class="spec val" id="val-validate_message_header"><a href="#val-validate_message_header" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>validate_message_header : (<a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a><span class="keyword"> * </span><a href="../../protocol/Full_messages/index.html#type-fix_header">Full_messages.fix_header</a><span class="keyword"> * </span><a href="../../protocol/Full_message_tags/index.html#type-full_msg_tag">Full_message_tags.full_msg_tag</a>) <span class="keyword">&#8209;&gt;</span> <a href="../Fix_engine_state/index.html#type-fix_engine_state">Fix_engine_state.fix_engine_state</a> option</code></div><div class="doc"><p>Check the message header ( presence and value of the OrigSendingTime )
returns None if no problems are found.</p></div></div></body></html>